find_package(MKL)

if(MKL_FOUND)
  option(USE_MKL "Use MKL to speed up Eigen operations" YES)
endif()

if(MKL_FOUND AND USE_MKL) 
  message("dirs: ${MKL_LIBRARY_DIRS}")
  add_library(MKL INTERFACE IMPORTED)
  set_property(TARGET MKL PROPERTY INTERFACE_INCLUDE_DIRECTORIES ${MKL_INCLUDE_DIRS})
  set_property(TARGET MKL PROPERTY INTERFACE_LINK_LIBRARIES ${MKL_LIBRARIES})
  set_property(TARGET MKL PROPERTY INTERFACE_COMPILE_OPTIONS "-L${MKL_LIBRARY_DIRS}")
  set_property(TARGET MKL PROPERTY INTERFACE_COMPILE_DEFINITIONS "EIGEN_USE_MKL_ALL")
  set(MKL_TARGET MKL)
else()
  set(MKL_TARGET "")
endif()
